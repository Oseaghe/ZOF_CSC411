<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zero of Functions Solver</title>

<!-- Math.js for parsing math expressions -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.9.0/math.min.js"></script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 20px;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    border-radius: 15px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    overflow: hidden;
}

header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    text-align: center;
}

header h1 { font-size: 2.5em; margin-bottom: 10px; }
header p { font-size: 1.1em; opacity: 0.9; }

.content { padding: 30px; }
.method-selector { margin-bottom: 30px; }

.method-selector label {
    display: block;
    font-size: 1.1em;
    font-weight: 600;
    margin-bottom: 10px;
    color: #333;
}

.method-selector select {
    width: 100%;
    padding: 12px;
    font-size: 1em;
    border: 2px solid #ddd;
    border-radius: 8px;
    background: white;
    cursor: pointer;
    transition: border-color 0.3s;
}

.method-selector select:focus {
    outline: none;
    border-color: #667eea;
}

.input-section {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
}

.form-group { margin-bottom: 20px; }
.form-group label { font-weight: 600; margin-bottom: 8px; color: #555; display: block; }
.form-group input {
    width: 100%;
    padding: 10px;
    font-size: 1em;
    border: 2px solid #ddd;
    border-radius: 6px;
    transition: border-color 0.3s;
}
.form-group input:focus { outline: none; border-color: #667eea; }
.form-group small { display: block; margin-top: 5px; color: #888; font-style: italic; }

.input-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.btn-solve {
    width: 100%;
    padding: 15px;
    font-size: 1.2em;
    font-weight: 600;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}

.btn-solve:disabled { background: #ccc; cursor: not-allowed; }

.results { margin-top: 30px; display: none; }
.results.show { display: block; }

.result-summary {
    background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    color: white;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
}

.result-summary.error {
    background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
}

.result-summary h3 { font-size: 1.5em; margin-bottom: 15px; }
.result-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.2); }

.iterations-table {
    background: white;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.iterations-table h3 {
    background: #667eea;
    color: white;
    margin: 0;
    padding: 15px 20px;
}

.table-container { overflow-x: auto; max-height: 500px; }
table { width: 100%; border-collapse: collapse; }
th, td { text-align: center; padding: 10px; }

.loading { display: none; text-align: center; padding: 20px; }
.loading.show { display: block; }

.spinner {
    width: 50px; height: 50px;
    border: 4px solid #f3f3f3;
    border-top: 4px solid #667eea;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 15px;
}

@keyframes spin { 100% { transform: rotate(360deg); } }

.method-info {
    background: #e3f2fd;
    border-left: 4px solid #2196f3;
    padding: 15px;
    border-radius: 5px;
}

@media (max-width: 768px) {
    header h1 { font-size: 1.8em; }
    .content { padding: 15px; }
    .input-grid { grid-template-columns: 1fr; }
}
</style>
</head>

<body>
<div class="container">
    <header>
        <h1>üî¢ Zero of Functions Solver</h1>
        <p>Numerical Methods for Root Finding</p>
    </header>

    <div class="content">
        <div class="method-selector">
            <label>Select Numerical Method:</label>
            <select id="method" onchange="updateInputFields()">
                <option value="">-- Choose a Method --</option>
                <option value="bisection">Bisection</option>
                <option value="regula_falsi">Regula Falsi</option>
                <option value="secant">Secant</option>
                <option value="newton_raphson">Newton-Raphson</option>
                <option value="fixed_point">Fixed Point</option>
                <option value="modified_secant">Modified Secant</option>
            </select>
        </div>

        <div id="methodInfo" class="method-info" style="display: none;"></div>

        <div class="input-section">
            <div class="form-group">
                <label>Function f(x):</label>
                <input type="text" id="function" placeholder="e.g., x^3 - x - 2">
                <small id="functionHint">
                    Enter function in plain math format: use x as variable, ^ for powers, e.g., x^3 - x - 2, sin(x), log(x)
                </small>
            </div>

            <div id="dynamicInputs"></div>

            <div class="input-grid">
                <div class="form-group">
                    <label>Tolerance:</label>
                    <input type="text" id="tolerance" value="0.000001">
                </div>
                <div class="form-group">
                    <label>Max Iterations:</label>
                    <input type="number" id="max_iterations" value="100">
                </div>
            </div>

            <button class="btn-solve" onclick="solveEquation()" id="solveBtn" disabled>Solve Equation</button>
        </div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Computing solution...</p>
        </div>

        <div id="results" class="results"></div>
    </div>
</div>

<script>
const methodInfoData = {
    bisection: {inputs: ['a','b'], info: 'Bisection uses interval halving.'},
    regula_falsi: {inputs: ['a','b'], info: 'False position uses linear interpolation.'},
    secant: {inputs: ['x0','x1'], info: 'Secant uses two initial guesses.'},
    newton_raphson: {inputs: ['x0'], info: 'Newton-Raphson uses derivative estimation.'},
    fixed_point: {inputs: ['x0'], info: 'Fixed point iteration: x = g(x)'},
    modified_secant: {inputs: ['x0','delta'], info: 'Modified secant approximates derivative numerically.'}
};

const inputLabels = {a:'Lower Bound (a)',b:'Upper Bound (b)',x0:'Initial Guess (x‚ÇÄ)',x1:'Second Guess (x‚ÇÅ)',delta:'Delta (Œ¥)'};
const inputPlaceholders = {a:'0',b:'2',x0:'1.5',x1:'2.0',delta:'0.01'};

function updateInputFields() {
    const method = document.getElementById('method').value;
    const dynamicInputs = document.getElementById('dynamicInputs');
    const solveBtn = document.getElementById('solveBtn');
    const methodInfoDiv = document.getElementById('methodInfo');
    if(!method){ dynamicInputs.innerHTML=''; solveBtn.disabled=true; methodInfoDiv.style.display='none'; return;}
    solveBtn.disabled=false;
    const info = methodInfoData[method];
    methodInfoDiv.innerHTML=`<h4>About This Method</h4><p>${info.info}</p>`;
    methodInfoDiv.style.display='block';
    let html='<div class="input-grid">';
    info.inputs.forEach(input=>{
        html+=`<div class="form-group"><label>${inputLabels[input]}:</label><input type="text" id="${input}" placeholder="${inputPlaceholders[input]}"></div>`;
    });
    html+='</div>'; dynamicInputs.innerHTML=html;
    document.getElementById('results').classList.remove('show');
}

// parse plain math string using math.js
function parseFunction(funcStr){
    try{return math.parse(funcStr).compile();}
    catch(err){alert('Invalid function format. Example: x^3 - x - 2, sin(x), log(x)'); throw err;}
}

async function solveEquation(){
    const method = document.getElementById('method').value;
    const funcStr = document.getElementById('function').value;
    if(!method||!funcStr){alert('Select method and enter function'); return;}
    const data={method,func:funcStr,tolerance:document.getElementById('tolerance').value,max_iterations:document.getElementById('max_iterations').value};
    methodInfoData[method].inputs.forEach(input=>{data[input]=document.getElementById(input).value;});
    document.getElementById('loading').classList.add('show');
    document.getElementById('results').classList.remove('show');

    try{
        const response = await fetch('/solve',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
        const result = await response.json();
        displayResults(result);
    }catch(err){displayResults({error:'Connection error: '+err.message});}
    document.getElementById('loading').classList.remove('show');
}

function displayResults(result){
    const resultsDiv = document.getElementById('results');
    if(result.error){resultsDiv.innerHTML=`<div class="result-summary error"><h3>Error</h3><p>${result.error}</p></div>`; resultsDiv.classList.add('show'); return;}
    let summaryHtml=`<div class="result-summary"><h3>Solution Found</h3><div class="result-item"><label>Root:</label><span>${result.root}</span></div><div class="result-item"><label>Final Error:</label><span>${result.final_error}</span></div><div class="result-item"><label>Iterations:</label><span>${result.iterations.length}</span></div></div>`;
    let tableHtml='';
    if(result.iterations && result.iterations.length>0){
        const headers=Object.keys(result.iterations[0]);
        tableHtml=`<div class="iterations-table"><h3>Iteration Details</h3><div class="table-container"><table><thead><tr>`;
        headers.forEach(h=>tableHtml+=`<th>${h}</th>`);
        tableHtml+='</tr></thead><tbody>';
        result.iterations.forEach(iter=>{tableHtml+='<tr>'; headers.forEach(h=>tableHtml+=`<td>${iter[h]}</td>`); tableHtml+='</tr>';});
        tableHtml+='</tbody></table></div></div>';
    }
    resultsDiv.innerHTML=summaryHtml+tableHtml;
    resultsDiv.classList.add('show');
}

document.getElementById('method').addEventListener('change',()=>{document.getElementById('solveBtn').disabled=!document.getElementById('method').value;});
</script>

</body>
</html>
